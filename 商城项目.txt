库存与订单问题 https://www.jianshu.com/p/f9af5fbe419e

分布式监听redis过期消息：
方案1：根据获取的服务的节点id,订阅key失效事件，集群中只有1个节点去订阅key过期，那么不存在重复消费。
方案2：每个节点都去订阅，但是每个节点可以按照失效key hash分片，如有n个节点，那么每个节点处理1/n的失效key，也不存在重复消费。
12需要补偿机制，如果方案1的处理节点下线，或者方案2的任意节点下线，会导致过期事件无法监听或者1/N的过期KEY 无法处理，节点下线转移到其他节点上
方案3：最简单，处理的时候按失效key生成一个唯一ID（同一次过期事件，所有节点收到相同的KEY生成的ID必须一样），调用redis setNx，调用成功的节点处理，然后setnx保留的数据，可以间隔一定的时间清理。